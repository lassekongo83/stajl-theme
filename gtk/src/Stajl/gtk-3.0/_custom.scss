// This file is used to apply some larger unofficial custom styles to the Adwaita base.

//---------------//
// Title buttons //
//---------------//
%titlebutton {
  min-width: 24px;
  min-height: 24px;
  padding: 0;
  margin: 2px;
  border-radius: 1.5px;
}

%titlebuttons {
  button.titlebutton {
    @extend %titlebutton;

    &.close, &.maximize, &.minimize {
      color: transparent;
      background-color: transparent;
      background-position: center;
      background-repeat: no-repeat;
      border-width: 0;
      box-shadow: none;
      transition-property: background-color;
    }

    &.close {
      background-color: $close_button;

      &:hover, &:active { background-color: $close_button_hover; }
      &:backdrop {
        background-color: $close_button_backdrop;
        &:hover, &:active { background-color: $close_button_hover; }
      }
    }
    
    &.maximize, &.minimize { 
      &:hover, &:active { background-color: if($variant == 'light' and $alt_header == 'false', $selected_bg_color, transparentize(white, 0.8)); }
    }

    // titlebutton icons
    @each $k in ('close', 'maximize', 'minimize') {
      @each $l, $m in ('',''), (':backdrop','-backdrop'), (':hover','-hover'), (':active','-hover') {
        &.#{$k}#{$l} {
          @if($variant=='light' and $alt_header=='false') {
            background-image: -gtk-scaled(url('assets/titlebutton-#{$k}#{$m}.png'),
                                          url('assets/titlebutton-#{$k}#{$m}@2.png'));
          }
          @else {
            background-image: -gtk-scaled(url('assets/titlebutton-#{$k}-hover.png'),
                                          url('assets/titlebutton-#{$k}-hover@2.png'));
          }
        }
      }
    }
    // Not working, needs investigation
    //@if variant=='dark' {
    //  &:not(:hover) { opacity: 0.8; } // slightly reduce the opacity of the otherwise very bright color in the dark theme
    //  &:backdrop:not(:hover) { opacity: 0.5; }
    //}
  }

  // unmaximize titlebutton icon
  .maximized & {
    button.titlebutton {
      @each $l, $m in ('',''), (':backdrop','-backdrop'), (':hover','-hover'), (':active','-hover') {
        &.maximize#{$l} {
          @if($variant=='light' and $alt_header=='false') {
            background-image: -gtk-scaled(url('assets/titlebutton-unmaximize#{$m}.png'),
                                          url('assets/titlebutton-unmaximize#{$m}@2.png'));
          }
          @else {
            background-image: -gtk-scaled(url('assets/titlebutton-unmaximize-hover.png'),
                                          url('assets/titlebutton-unmaximize-hover@2.png'));
          }
        }
      }
      //@if variant=='dark' {
      //  &:not(:hover) { opacity: 0.8; } // slightly reduce the opacity of the otherwise very bright color in the dark theme
      //  &:backdrop:not(:hover) { opacity: 0.5; }
      //}
    }
  }
}

.ssd .titlebar {
  border-width: 0;
  padding: 2px 4px;

  &.default-decoration button.titlebutton {
    @extend %titlebutton;
  }
}

//--------------------//
// Dark/alt headerbar //
//--------------------//
// not used in the dark theme
$_button_bg_color: lighten($alt_headerbar_bg, 7.5%) !global;
$_button_border_color: darken($alt_headerbar_bg, 10%) !global;

%alt_titlebar {
  color: $alt_headerbar_fg;
  &:backdrop { color: $alt_headerbar_backdrop_fg; }

  label .title {
    color: $alt_headerbar_fg;
    &:backdrop { color: $alt_headerbar_backdrop_fg; }
  }

  .maximized &,
  .fullscreen & { box-shadow: none; }

  entry {
    &, &:backdrop {
      border-color: darken($alt_headerbar_bg, 8%);
    }
    &:focus { @include entry(focus); }
  }

  button,
  button.toggle,
  button.popup.toggle,
  button.image-button,
  button.image-button.toggle,
  button.text-button,
  button.text-button.toggle,
  box button.toggle,
  buttonbox.toggle,
  stackswitcher button,
  filechooser .path-bar.linked>button,
  .path-bar button {
    &:backdrop { color: $alt_headerbar_backdrop_fg; }
    @include button(normal, $_button_bg_color, $alt_headerbar_fg);
    &.flat {
      @include button(undecorated);
    }

    &:hover {
      @include button(hover, $_button_bg_color, $alt_headerbar_fg);
    }
    &:active,
    &:checked {
      @include button(active, $_button_bg_color, $alt_headerbar_fg);
      border-color: transparentize(black, 0.6);
    }
  }

  separator {
    background: image(lighten($_button_border_color, 5%));
  }
}

@if $alt_header=='true' {
  .titlebar, headerbar { @extend %alt_titlebar; }
  .ssd .titlebar {
    @include headerbar_fill($alt_headerbar_bg);
    color: $alt_headerbar_fg;
    border-width: 0;
    &:backdrop { color: $alt_headerbar_backdrop_fg; }
  }
}

//-------------------//
// Scrollbar buttons //
//-------------------//
%scrollbuttons {
  // button icons
  &.vertical {
    button {
      @each $s,$as in ('',''),
                      (':disabled','-insensitive') {
        &.up#{$s} {
            $_url: if($variant=='dark', 'assets/scrollarrow-up#{$asset_suffix}', 'assets/scrollarrow-up#{$as}');
            -gtk-icon-source: -gtk-scaled(url('#{$_url}.png'),
                                          url('#{$_url}@2.png'));
        }

        &.down#{$s} {
            $_url: if($variant=='dark', 'assets/scrollarrow-down#{$asset_suffix}', 'assets/scrollarrow-down#{$as}');
            -gtk-icon-source: -gtk-scaled(url('#{$_url}.png'),
                                          url('#{$_url}@2.png'));
        }
      }
    }
  }

  &.horizontal {
    button {
      @each $s,$as in ('',''),
                      (':disabled','-insensitive') {
        &.up#{$s} {
            $_url: if($variant=='dark', 'assets/scrollarrow-left#{$asset_suffix}', 'assets/scrollarrow-left#{$as}');
            -gtk-icon-source: -gtk-scaled(url('#{$_url}.png'),
                                          url('#{$_url}@2.png'));
        }

        &.down#{$s} {
            $_url: if($variant=='dark', 'assets/scrollarrow-right#{$asset_suffix}', 'assets/scrollarrow-right#{$as}');
            -gtk-icon-source: -gtk-scaled(url('#{$_url}.png'),
                                          url('#{$_url}@2.png'));
        }
      }
    }
  }
}

//------//
// XFCE //
//------//

// Global panel button styles
%panelbutton {
  background-image: none;
  background-color: transparent;
  border: none;
  border-radius: 0;
  border-color: transparent;
  box-shadow: none;
  padding: 0 1px;
  color: transparentize($osd_fg_color, 0.05);

  &:hover {
    color: $selected_fg_color;
    background-color: lighten($osd_bg_color, 4%);
  }
  &:active, &:checked {
    color: $selected_fg_color;
    background-color: $selected_bg_color;
    &:hover { background-color: lighten($selected_bg_color, 4%); }
  }
}

.XfceHeading {
  margin: 0;
  padding: 0;
  border-width: 0;
  background-image: none;
  background-color: darken($bg_color, 10%);
  color: $text_color;
}

.xfce4-panel.background {
  background-color: $osd_bg_color;
  color: $osd_fg_color;
  font-weight: normal;

  button { @extend %panelbutton; }

  entry { caret-color: $text_color; }
  menu {
    -gtk-icon-effect: none;

    text-shadow: none;
    // Theme pulseaudio-plugin's mpris buttons
    .linked button {
      @extend %linked;
      @include button(normal, $menu_color, $text_color);
        &:disabled {
          @include button(insensitive);
          border-color: transparentize($borders_color, 0.5);
        }
      }
    }
  progressbar {
    margin: 0;

    &.horizontal {
      trough { min-height: 6px; padding: 0; }
      progress { min-height: 4px; }
    }
    &.vertical {
      trough { min-width: 6px; padding: 0; }
      progress { min-width: 4px; }
    }
    progress { border-radius: 0px; }
    trough {
      background: darken($osd_bg_color, 10%);
      border-radius: 0px;
      border-color: darken($osd_bg_color, 18%);
    }
  }
  .tasklist button {
    border-radius: $button_radius;
    color: darken($osd_fg_color, 5%);
    border: none;
    background: $osd_bg_color;

    &.flat {
      background-image: none;
      border: none;
      box-shadow: none;
    }
    &:active, &:checked {
      background: darken($osd_bg_color, 10%);
      color: $osd_fg_color;
    }
    &:hover, &:active:hover, &:checked:hover {
      background: darken($osd_bg_color, 5%);
      color: $osd_fg_color;
    }
    image { padding: 3px; }
  }
  &.horizontal .tasklist {
    button {
      margin: 0 1px;
      label { padding-right: 3px; }
    }
  }
  &.vertical .tasklist {
    button {
      margin: 1px 0;
      label { padding-bottom: 3px; }
    }
  }
}

// Workspace switcher provided by libwnck
wnck-pager {
  &:selected { background-color: darken($selected_bg_color, 10%); }
  &:hover { background-color: $selected_bg_color; }
}

XfdesktopIconView.view {
  background: transparent;
  color: $osd_fg_color;
  border-radius: $button_radius;
  &:active {
    background: rgba(darken($selected_bg_color, 15%), 0.5);
    text-shadow: 0 1px 1px black;
  }
  .label { text-shadow: 1px 1px 2px black; }
  .rubberband {
    @extend rubberband;
    border-radius: 0;
  }
}

#XfceNotifyWindow {
  @extend %osd;
  border-radius: $window_radius;

  buttonbox { padding: 0; }

  button {
    @include button(osd);
    &:hover, &:focus { @include button(osd-hover); }
    &:active, &:checked { @include button(osd-active); }
    &:active:hover, &:checked:hover { @include button(osd-active); }
    &.default { @include button(osd-hover); }
    &:disabled { @include button(osd-insensitive); }

    border-radius: $button_radius;
    text-shadow: none;
  }

  entry {
    @include entry(osd);
    border-radius: $button_radius;
    text-shadow: none;
  }

  label#summary {
    font-weight: bold;
  }

  progressbar {
    min-height: 6px;
    border-radius: $button_radius;
    progress {
      background-image: none;
      background-color: $selected_bg_color;
      border: none;
      box-shadow: none;
    }
    trough {
      background-color: lighten($osd_bg_color, 10%);
      border: none;
      border-radius: $button_radius;
      padding: 1px 0;
    }
  }
}

// Xfwm4's alt-tab dialog, aka "tabwin"
#xfwm-tabwin {
  padding: 12px;
  background-image: none;
  background-color: transparentize(black, 0.2);
  color: shade($selected_fg_color, 0.65);
  text-shadow: 0px 1px transparentize(black, 0.2);
  border-radius: 12px;
  // Set the application icon- and preview-size to 64px
  -XfwmTabwinWidget-icon-size: 64px;
  -XfwmTabwinWidget-preview-size: 64px;

  button {
    background-image: none;
    color: $selected_fg_color;
    font-weight: bold;
    text-shadow: 0px 1px transparentize(black, 0.2);
    border: none;
    border-radius: 6px;
    box-shadow: none;

    &:active, &:checked, &:active:hover, &:checked:hover {
      background-color: $selected_bg_color;
    }
    &:hover {
      background-color: $selected_bg_color;
      transition-duration: $shorter_duration;
    }
  }
}

//------//
// Apps //
//------//

// Styling 3rd party apps should be avoided as much as possible

// Nautilus
.nautilus-window {
  // Workaround for https://bugzilla.gnome.org/show_bug.cgi?id=724096
  searchbar { border-top: 1px solid $borders_color; }
  .searchbar-container { margin-top: -1px; }

  // sidebar separator
  paned {
    > separator {
      background-image: none;
      background-size: 0;
      background-color: $borders_color;
    }
  }

  // sidebar
  .sidebar {
    box-shadow: inset -1px 0 transparentize($borders_color, 0.8), inset -2px 0 transparentize($borders_color, 0.9);
  }

  // Without this nautilus iconview grabs the bg_color
  notebook,
  notebook > stack:not(:only-child) searchbar { @extend %view; }

  // pathbar
  //.nautilus-path-bar button {
  //  @include button(undecorated);
  //  &:hover, &:last-child {
  //    box-shadow: 0 3px $selected_bg_color;
  //    border-radius: 0;
  //  }
  //}
}

// disk space pie
.disk-space-display {
  border-style: solid;
  border-width: 2px;

  &.unknown {
    background-color: darken($bg_color, 20%);
    border-color: darken($bg_color, 30%);
  }
  &.used {
    background-color: $selected_bg_color;
    border-color: darken($selected_bg_color, 20%);
  }
  &.free {
    background-color: $bg_color;
    border-color: darken($bg_color, 20%);
  }
}

// Thunar
.thunar {
  .standard-view { border-width: 0; }
  .sidebar .view {
    background-color: $sidebar_bg_color;
    &:hover { background-color: $base_hover_color; }
    &:selected { background-color: $selected_bg_color; }
  }

  toolbar {
    border-bottom: 1px solid $borders_color;
    entry { margin: 2px; }
  }

  // https://github.com/lassekongo83/plano-theme/issues/37
  .shortcuts-pane { border-top: 0; }
}

// gnome-tweaks
.tweak-categories {
  background-color: mix($bg_color, $base_color, 50%);
  box-shadow: inset -1px 0 transparentize($borders_color, 0.8), inset -2px 0 transparentize($borders_color, 0.9);
  border-color: $borders_color;
}

list.tweak-categories separator {
  // hide sidebar separators
  // make the sidebar look like a normal sidebar
  background: transparent;
}
